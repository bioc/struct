---
output: 
  pdf_document:
    highlight: haddock
  html_document:
    theme: journal
    highlight: haddock
  header-includes:
    \usepackage{booktabs}
    \usepackage{longtable}
    \usepackage{array}
    \usepackage{multirow}
    \usepackage[table]{xcolor}
    \usepackage{wrapfig}
    \usepackage{float}
    \usepackage{colortbl}
    \usepackage{pdflscape}
    \usepackage{tabu}
    \usepackage{threeparttable}
    \usepackage{threeparttablex}
    \usepackage[normalem]{ulem}
    \usepackage{makecell}
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(structtoolbox)
library(knitr)
library(kableExtra)

simpleCap <- function(x) {
  s <- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), substring(s, 2),
        sep="", collapse=" ")
}

example_figure = function(obj,chartname)
{
X=iris
# turn it into a dataset object
D=dataset(data=X[,1:4],
          sample_meta=X[,5,drop=FALSE],
          name='Iris data',
          description='The data used in Fisher\'s paper')
  tr=model.train(obj,D)
  tr=model.predict(tr,D)
  out=chart.plot(chartname,tr)
  ggplot2::ggsave(filename = paste0('tempfig',name(chartname),'.png'),width=5,height=5,units='in')
}
```

# `r simpleCap(stato.name(obj))` (`r stato.id(obj)`) {.tabset}

### STATO definition:

> `r stato.definition(obj)`  


### Description:  

> `r description(obj)`  


### Examples:

```r
# create model object  
M = `r class(obj)`()  
# Train the model using data in D   
M = train(M,D)  
# apply model to test data Z  
M = predict(M,Z)  
```

## Inputs {.tabset}

```{r,results='asis',echo=FALSE}
p=param.ids(obj)


for (i in p)
{
  child.obj=param.obj(obj,i)
  M=matrix(nrow=1,ncol=2)
  
  cat('<hr style="color:grey;background-color:grey;border:1px solid" />')
  
  M[1,]=c('param id:',paste0('<b>',i,'</b>'))
  N=matrix(nrow=1,ncol=2)
  if (is(child.obj,'entity.stato'))
  {
    N[1,]=c('STATO name:',paste0(stato.name(child.obj),' (',stato.id(child.obj), ')'))
    M=rbind(M,N)
  }
  if (is(child.obj,'entity'))
  {
    N[1,]=c('Name:',name(child.obj))
    M=rbind(M,N)
  }
  if (is(child.obj,'entity.stato'))
  {
    N[1,]=c('STATO definition:',stato.definition(child.obj))
    M=rbind(M,N)
  }
  if (is(child.obj,'entity'))
  {
    N[1,]=c('Description:',description(child.obj))
    M=rbind(M,N)
  }
      N[1,]=c('Example:','')
  M=rbind(M,N)
  
  K=kable(M,format='html',escape=FALSE) %>%
    kable_styling(full_width=T) %>%
    column_spec(1,width = "20%")
  cat(K)

  
  cat('

~~~r 
# set during object creation		     
M = ',class(obj),'("',i,'" = 4)	       
# set for existing object   
param.value(M,"',i,'") = 2         
~~~~

',sep="")
}
```


## Outputs  {.tabset}

```{r,results='asis',echo=FALSE}
p=output.ids(obj)


for (i in p)
{

  child.obj=output.obj(obj,i)
  M=matrix(nrow=1,ncol=2)
  

  
  cat('<hr style="color:grey;background-color:grey;border:1px solid" />')
  M[1,]=c('output id:',paste0('<b>',i,'</b>'))
  N=matrix(nrow=1,ncol=2)
  if (is(child.obj,'entity.stato'))
  {
    N[1,]=c('STATO name:',paste0(stato.name(child.obj),' (',stato.id(child.obj), ')'))
    M=rbind(M,N)
  }
  if (is(child.obj,'entity'))
  {
    N[1,]=c('Name:',name(child.obj))
    M=rbind(M,N)
  }
  if (is(child.obj,'entity.stato'))
  {
    N[1,]=c('STATO definition:',stato.definition(child.obj))
    M=rbind(M,N)
  }
  if (is(child.obj,'entity'))
  {
    N[1,]=c('Description:',description(child.obj))
    M=rbind(M,N)
  }
  N[1,1]='Example:'
  N[1,2]=''
  M=rbind(M,N)
  
  K=kable(M,format='html',escape=FALSE) %>%
    kable_styling(full_width=T) %>%
    column_spec(1,width = "20%")
  cat(K)
  cat('

~~~r 
# get value of output		     
value = output.value(M,"',i,'")         
~~~~

',sep="")

}
```


## Charts  {.tabset}

```{r,results='asis',echo=FALSE,out.width='50%',out.height='50%'}
child.obj=chart.names(obj,ret='obj')
n=chart.names(obj,ret='char')

for (i in 1:length(p))
{
  M=matrix(nrow=1,ncol=2)
  N=M
  
  cat('<hr style="color:grey;background-color:grey;border:1px solid" />')
  M[1,]=c('chart id:',paste0('<b>',i,'</b>'))
  N=matrix(nrow=1,ncol=2)
  if (is(child.obj,'chart.stato'))
  {
    N[1,]=c('STATO name:',paste0(stato.name(child.obj[i]),' (',stato.id(child.obj[i]), ')'))
    M=rbind(M,N)
  }
  if (is(child.obj,'chart'))
  {
    N[1,]=c('Name:',name(child.obj[i]))
    M=rbind(M,N)
  }
  if (is(child.obj,'chart.stato'))
  {
    N[1,]=c('STATO definition:',stato.definition(child.obj[i]))
    M=rbind(M,N)
  }
  if (is(child.obj,'chart'))
  {
    N[1,]=c('Description:',description(child.obj[i]))
    M=rbind(M,N)
  }
  example_figure(obj,child.obj[[i]])
  N[1,]=c('Example:','')
  M=rbind(M,N)
  
  K=kable(M,format='html',escape=FALSE) %>%
    kable_styling(full_width=T) %>%
    column_spec(1,width = "20%")
  cat(K)
cat('

~~~r 
C=',paste0(n[i],'()'),'
# plot the chart
chart.plot(M,C)
~~~~

',sep="")
  
  cat('<p><center> ![](',file.path(path.package("struct"),paste0('tempfig_',n[i],'.png')),'){ width=75% height=75% } </center></p>')
  
}


```



